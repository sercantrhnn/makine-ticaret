{% extends 'public/base.html.twig' %}

{% block title %}{{ 'Alım Talebi Mesajları'|auto_translate(app.request.locale) }} - {{ pr|smart_translate('productName', app.request.locale) }}{% endblock %}

{% block header %}
<header class="main-header">
  <div class="header-container">
    <a href="{{ path('public_home') }}" class="logo-link">
      <img src="{{ asset('mineindustries_logo_transparent_pad8.png') }}" alt="Makine Ticaret" class="logo-img"/>
    </a>
    <button class="mobile-menu-btn" id="mobileMenuBtn"><span></span><span></span><span></span></button>
    <nav class="main-nav" id="mainNav">
      <a href="{{ path('public_products') }}" class="nav-link">{{ 'Ürünler'|auto_translate(app.request.locale) }}</a>
      <a href="{{ path('public_categories') }}" class="nav-link">{{ 'Kategoriler'|auto_translate(app.request.locale) }}</a>
      <a href="{{ path('public_companies') }}" class="nav-link">{{ 'Firmalar'|auto_translate(app.request.locale) }}</a>
      <a href="{{ path('public_bids') }}" class="nav-link">{{ 'İhaleler'|auto_translate(app.request.locale) }}</a>
    </nav>
  </div>
</header>
{% endblock %}

{% block body %}
<style>
  .main-header { position: sticky; top: 0; z-index: 60; background: #0a0a0a; border-bottom: 1px solid #1a1a1a; }
  .header-container { max-width: 80%; margin: 0 auto; padding: 10px 16px; display: flex; align-items: center; justify-content: space-between; color: #fff; }
  .logo-link { display: flex; align-items: center; text-decoration: none; color: #fff; z-index: 70; }
  .logo-img { height: 44px; width: auto; border-radius: 6px; object-fit: contain; display: block; }
  .mobile-menu-btn { display: none; flex-direction: column; justify-content: space-around; width: 30px; height: 30px; background: transparent; border: none; cursor: pointer; padding: 0; z-index: 70; }
  .mobile-menu-btn span { width: 25px; height: 3px; background: #fff; border-radius: 3px; transition: all 0.3s linear; position: relative; transform-origin: 1px; }
  .main-nav { display: flex; gap: 22px; align-items: center; }
  .nav-link { color: #bdbdbd; text-decoration: none; font-size: 14px; transition: color 0.3s ease; }
  .nav-link.active { color: #e5e5e5; font-weight: 600; }
  @media (max-width: 1024px) { .header-container { max-width: 100%; padding: 10px 16px; } .mobile-menu-btn { display: flex; } .main-nav { position: fixed; top: 56px; left: 0; right: 0; bottom: 0; background: rgba(10,10,10,0.98); padding: 20px; display: flex; flex-direction: column; gap: 14px; transform: translateX(100%); transition: transform 0.3s ease; z-index: 50; } .main-nav.active { transform: translateX(0); } .nav-link { font-size: 18px; padding: 10px 20px; } }
  @media (max-width: 480px) { .header-container { padding: 8px 12px; } .logo-img { height: 36px; } .nav-link { font-size: 16px; } }

  /* Footer Styles */
  .main-footer { background: #0a0a0a; color: #bdbdbd; border-top: 1px solid #1a1a1a; }
  .footer-container { max-width: 80%; margin: 0 auto; padding: 28px 16px; display: flex; align-items: center; justify-content: space-between; gap: 16px; }
  .footer-brand { display: flex; align-items: center; gap: 10px; }
  .footer-logo { display: inline-flex; align-items: center; }
  .footer-logo-img { height: 46px; width: auto; border-radius: 6px; object-fit: contain; display: block; }
  .footer-nav { display: flex; gap: 18px; align-items: center; font-size: 13px; }
  .footer-link { color: #bdbdbd; text-decoration: none; transition: color 0.2s ease; }
  .footer-link:hover { color: #ffffff; }
  @media (max-width: 768px) { .footer-container { flex-direction: column; text-align: center; gap: 20px; padding: 24px 16px; } .footer-brand { flex-direction: column; gap: 8px; } .footer-nav { flex-wrap: wrap; justify-content: center; gap: 16px; } }
  @media (max-width: 480px) { .footer-container { padding: 20px 12px; } .footer-logo-img { height: 40px; } .footer-nav { gap: 12px; font-size: 12px; } }
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const mobileMenuBtn = document.getElementById('mobileMenuBtn');
  const mainNav = document.getElementById('mainNav');
  if (mobileMenuBtn && mainNav) {
    mobileMenuBtn.addEventListener('click', function() {
      mainNav.classList.toggle('active');
      mobileMenuBtn.classList.toggle('active');
    });
    document.querySelectorAll('#mainNav .nav-link').forEach(function(link){
      link.addEventListener('click', function(){
        mainNav.classList.remove('active');
        mobileMenuBtn.classList.remove('active');
      });
    });
    document.addEventListener('click', function(e){
      if (!mainNav.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
        mainNav.classList.remove('active');
        mobileMenuBtn.classList.remove('active');
      }
    });
  }
});
</script>

<div style="min-height: calc(100vh - 120px);">
<section class="py-8">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8" style="max-width:80%;padding-left:16px;padding-right:16px;">
    <div class="mb-4">
      <a href="{{ path('user_messages_inbox') }}" class="text-sm text-gray-600 hover:text-gray-900">← {{ 'Mesajlarım'|auto_translate(app.request.locale) }}</a>
    </div>
    <div class="bg-white rounded-lg border border-gray-200">
      <div class="px-6 py-4 border-b border-gray-100">
        <div class="mb-4">
          <h1 class="text-lg font-semibold text-gray-900">{{ pr|smart_translate('productName', app.request.locale) }}</h1>
          <p class="text-sm text-gray-500">{{ 'Alım Talebi'|auto_translate(app.request.locale) }}</p>
        </div>
        
        <!-- Alım Talebi Bilgileri -->
        <div class="bg-gray-50 rounded-lg p-4 mb-4">
          <h3 class="text-sm font-semibold text-gray-900 mb-2">{{ 'Alım Talebi Detayları'|auto_translate(app.request.locale) }}</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
            <div>
              <span class="text-gray-600">{{ 'Ürün Adı'|auto_translate(app.request.locale) }}:</span>
              <span class="text-gray-900">{{ pr|smart_translate('productName', app.request.locale) }}</span>
            </div>
            <div>
              <span class="text-gray-600">{{ 'Talep Tarihi'|auto_translate(app.request.locale) }}:</span>
              <span class="text-gray-900">{{ pr.date|date('d.m.Y H:i') }}</span>
            </div>
            <div class="md:col-span-2">
              <span class="text-gray-600">{{ 'Açıklama'|auto_translate(app.request.locale) }}:</span>
              <span class="text-gray-900">{{ pr|smart_translate('description', app.request.locale)|default(('Açıklama yok'|auto_translate(app.request.locale))) }}</span>
            </div>
            <div>
              <span class="text-gray-600">{{ 'Telefon'|auto_translate(app.request.locale) }}:</span>
              <span class="text-gray-900">{{ pr.phone|default(('Belirtilmemiş'|auto_translate(app.request.locale))) }}</span>
            </div>
            <div>
              <span class="text-gray-600">{{ 'E-posta'|auto_translate(app.request.locale) }}:</span>
              <span class="text-gray-900">{{ pr.email }}</span>
            </div>
          </div>
        </div>
        
        <div class="text-sm text-gray-700">{{ 'Firma sahibi ile mesajlaşma'|auto_translate(app.request.locale) }}</div>
      </div>
      <div class="p-6 space-y-3 max-h-[60vh] overflow-auto">
        {% for message in messages %}
          <div class="p-3 rounded-lg border {{ message.sender == app.user ? 'bg-indigo-50 border-indigo-100' : 'bg-gray-50 border-gray-200' }}">
            <div class="flex items-center justify-between">
              <div class="text-sm font-medium text-gray-900">
                {% if message.sender == app.user %}
                  {{ 'Siz'|auto_translate(app.request.locale) }}
                {% else %}
                  {{ 'Firma Sahibi'|auto_translate(app.request.locale) }}
                {% endif %}
              </div>
              <div class="text-xs text-gray-500">{{ message.createdAt|date('d.m.Y H:i') }}</div>
            </div>
            <div class="mt-2 text-sm text-gray-800">{{ message.content|auto_translate(app.request.locale)|nl2br }}</div>
          </div>
        {% else %}
          <div class="text-sm text-gray-500">{{ 'Henüz mesaj yok.'|auto_translate(app.request.locale) }}</div>
        {% endfor %}
      </div>
      <div class="px-6 py-4 border-t border-gray-100">
        {{ form_start(form) }}
        <div class="flex flex-col sm:flex-row gap-2">
          {{ form_widget(form.content, {'attr': {'class': 'flex-1 px-3 py-2 border border-gray-300 rounded-lg min-h-[44px]', 'rows': 2}}) }}
          <button type="submit" class="px-4 py-2 rounded-lg text-white w-full sm:w-auto" style="background:#0a0a0a;">{{ 'Gönder'|auto_translate(app.request.locale) }}</button>
        </div>
        {{ form_end(form) }}
      </div>
    </div>
  </div>
</section>
</div>
{% endblock %}

{% block footer %}
<footer class="main-footer">
  <div class="footer-container">
    <div class="footer-brand">
      <a href="{{ path('public_home') }}" class="footer-logo">
        <img src="{{ asset('mineindustries_logo_transparent_pad8.png') }}" alt="Makine Ticaret" class="footer-logo-img"/>
      </a>
      <span class="footeropyright">© {{ "now"|date("Y") }}</span>
    </div>
    <nav class="footer-nav">
      <a href="{{ path('public_products') }}" class="footer-link">{{ 'Ürünler'|auto_translate(app.request.locale) }}</a>
      <a href="{{ path('public_categories') }}" class="footer-link">{{ 'Kategoriler'|auto_translate(app.request.locale) }}</a>
      <a href="{{ path('public_companies') }}" class="footer-link">{{ 'Firmalar'|auto_translate(app.request.locale) }}</a>
      <a href="{{ path('public_bids') }}" class="footer-link">{{ 'İhaleler'|auto_translate(app.request.locale) }}</a>
    </nav>
  </div>
</footer>
{% endblock %}
