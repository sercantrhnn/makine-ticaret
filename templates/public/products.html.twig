{% extends 'public/base.html.twig' %}

{% block title %}{{ 'nav.products'|trans }}{% if search %} - "{{ search }}" {{ 'hero.search_button'|trans }}{% endif %}{% if selectedCategory %} - {{ selectedCategory|smart_translate('name', app.request.locale) }}{% endif %} | Makine Ticaret{% endblock %}
{% block description %}{% if selectedCategory %}{{ selectedCategory|smart_translate('name', app.request.locale) }} {{ 'categories.subcategories'|trans }}{% else %}{{ 'products.subtitle'|trans }}{% endif %}. {{ 'products.subtitle'|trans }}.{% endblock %}

{% block stylesheets %}
<style>
  html, body { background: linear-gradient(180deg, #f5f7fb 0%, #eef1f5 60%) !important; }
  main { background: transparent !important; }
  .page-dark { background: transparent; color:#111827; }
  .page-hero { background: linear-gradient(180deg, #f6f8fc 0%, #eef1f5 70%); }
  .hero-fade { height: 28px; background: linear-gradient(to bottom, rgba(238,241,245,0), #eef1f5); }
  .card-light { background:#ffffff; border-color:#e5e7eb; }
  .muted { color:#6b7280; }
  .accent-link { color:#374151; }
  .accent-link:hover { color:#111827; }
  .btn-neutral { background:#C0C0C0; color:#111111; transition: background-color .2s ease; box-shadow: 0 1px 2px rgba(0,0,0,.06); }
  .btn-neutral:hover { background:#B8B8B8; }
</style>
{% endblock %}

{% block header %}
<header class="main-header">
  <div class="header-container">
    <a href="{{ path('public_home') }}" class="logo-link">
      <img src="{{ asset('mineindustries_logo_transparent_pad8.png') }}" alt="Makine Ticaret" class="logo-img"/>
    </a>

    <!-- Mobile menu button -->
    <button class="mobile-menu-btn" id="mobileMenuBtn">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <nav class="main-nav" id="mainNav">
      <a href="{{ path('public_products') }}" class="nav-link active">{{ 'Ürünler'|auto_translate(app.request.locale) }}</a>
      <a href="{{ path('public_companies') }}" class="nav-link">{{ 'Firmalar'|auto_translate(app.request.locale) }}</a>
      <a href="{{ path('public_categories') }}" class="nav-link">{{ 'Kategoriler'|auto_translate(app.request.locale) }}</a>
      <a href="{{ path('public_bids') }}" class="nav-link">{{ 'İhaleler'|auto_translate(app.request.locale) }}</a>
      <a href="{{ path('purchase_request_new') }}" class="nav-link cta-link">{{ 'Alım Talebi Oluştur'|auto_translate(app.request.locale) }}</a>

      {% if app.user %}
        <div class="user-menu" id="userMenuRoot">
          <button id="userMenuButton" class="user-menu-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
            <span class="user-name">{{ (app.user.name ~ ' ' ~ app.user.surname)|trim ?: (app.user.username ?? app.user.email) }}</span>
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
          </button>
          <div id="userMenuDropdown" class="user-dropdown">
            <a href="{{ path('user_messages_inbox') }}" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16v16H4z" fill="none"/><path d="M22 6l-10 7L2 6"/></svg>
              <span>{{ 'Mesajlarım'|auto_translate(app.request.locale) }}</span>
            </a>
            <a href="{{ path('purchase_request_new') }}" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14M5 12h14"/></svg>
              <span>{{ 'Alım Talebi Oluştur'|auto_translate(app.request.locale) }}</span>
            </a>
            {% if 'ROLE_SUBSCRIBER' in app.user.roles %}
            <a href="{{ path('admin_dashboard') }}" class="dropdown-link admin-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
              <span>{{ 'İhale Oluştur'|auto_translate(app.request.locale) }}</span>
            </a>
            {% endif %}
            <a href="{{ path('app_logout') }}" class="dropdown-link logout-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/><path d="M10 17l5-5-5-5"/><path d="M15 12H3"/></svg>
              <span>{{ 'Çıkış Yap'|auto_translate(app.request.locale) }}</span>
            </a>
          </div>
        </div>
        <script>
          (function(){
            var btn = document.getElementById('userMenuButton');
            var dd = document.getElementById('userMenuDropdown');
            var root = document.getElementById('userMenuRoot');
            if (!btn || !dd || !root) return;
            btn.addEventListener('click', function(e){
              e.stopPropagation();
              dd.style.display = dd.style.display === 'none' || dd.style.display === '' ? 'block' : 'none';
            });
            document.addEventListener('click', function(e){
              if (!root.contains(e.target)) { dd.style.display = 'none'; }
            });
          })();
        </script>
      {% else %}
        <a href="{{ path('app_login') }}" class="nav-link">{{ 'Giriş Yap'|auto_translate(app.request.locale) }}</a>
        <a href="{{ path('app_register') }}" class="nav-link register-link">{{ 'Kayıt Ol'|auto_translate(app.request.locale) }}</a>
      {% endif %}

      <!-- Language Switcher -->
      <div class="language-switcher">
        {% include 'components/language-switcher-dark.html.twig' %}
      </div>
    </nav>
  </div>
</header>

<style>
.main-header {
  position: sticky;
  top: 0;
  z-index: 60;
  background: #0a0a0a;
  border-bottom: 1px solid #1a1a1a;
}

.header-container {
  max-width: 80%;
  margin: 0 auto;
  padding: 10px 16px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  color: #fff;
}

.logo-link {
  display: flex;
  align-items: center;
  text-decoration: none;
  color: #fff;
  z-index: 70;
}

.logo-img {
  height: 44px;
  width: auto;
  border-radius: 6px;
  object-fit: contain;
  display: block;
}

.mobile-menu-btn {
  display: none;
  flex-direction: column;
  justify-content: space-around;
  width: 30px;
  height: 30px;
  background: transparent;
  border: none;
  cursor: pointer;
  padding: 0;
  z-index: 70;
}

.mobile-menu-btn span {
  width: 25px;
  height: 3px;
  background: #fff;
  border-radius: 3px;
  transition: all 0.3s linear;
  position: relative;
  transform-origin: 1px;
}

.main-nav {
  display: flex;
  gap: 22px;
  align-items: center;
}

.nav-link {
  color: #bdbdbd;
  text-decoration: none;
  font-size: 14px;
  transition: color 0.3s ease;
}

.nav-link.active {
  color: #e5e5e5;
  font-weight: 600;
}

.nav-link.cta-link {
  color: #111111;
  background: #C0C0C0;
  font-size: 13px;
  font-weight: 700;
  padding: 6px 10px;
  border-radius: 8px;
}

.nav-link.register-link {
  color: #e5e5e5;
  font-weight: 600;
}

.language-switcher {
  margin-left: 10px;
}

.user-menu {
  position: relative;
}

.user-menu-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  background: transparent;
  border: 0;
  color: #e5e5e5;
  cursor: pointer;
  font-size: 14px;
}

.user-name {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 120px;
}

.user-dropdown {
  display: none;
  position: absolute;
  right: 0;
  top: calc(100% + 8px);
  background: #111214;
  border: 1px solid #222428;
  border-radius: 8px;
  min-width: 180px;
  box-shadow: 0 8px 24px rgba(0,0,0,.35);
  z-index: 100;
}

.dropdown-link {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 12px;
  color: #e5e5e5;
  text-decoration: none;
  font-size: 14px;
  transition: background-color 0.2s ease;
}

.dropdown-link:hover {
  background: #1a1a1a;
}

.dropdown-link.admin-link {
  border-top: 1px solid #1e2024;
}

.dropdown-link.logout-link {
  color: #ff7b7b;
  border-bottom-left-radius: 8px;
  border-bottom-right-radius: 8px;
}

/* Mobile Styles */
@media (max-width: 768px) {
  .header-container {
    max-width: 100%;
    padding: 10px 16px;
  }

  .mobile-menu-btn {
    display: flex;
  }

  .main-nav {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    background: #0a0a0a;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 30px;
    transform: translateX(-100%);
    transition: transform 0.3s ease;
    z-index: 50;
  }

  .main-nav.active {
    transform: translateX(0);
  }

  .nav-link {
    font-size: 18px;
    padding: 10px 20px;
  }

  .nav-link.cta-link {
    font-size: 16px;
    padding: 12px 24px;
  }

  .user-name {
    max-width: 150px;
  }

  .user-dropdown {
    right: -20px;
    min-width: 200px;
  }

  .language-switcher {
    margin-left: 0;
  }
}

@media (max-width: 480px) {
  .header-container {
    padding: 8px 12px;
  }

  .logo-img {
    height: 36px;
  }

  .nav-link {
    font-size: 16px;
  }

  .nav-link.cta-link {
    font-size: 14px;
    padding: 10px 20px;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const mobileMenuBtn = document.getElementById('mobileMenuBtn');
  const mainNav = document.getElementById('mainNav');

  if (mobileMenuBtn && mainNav) {
    mobileMenuBtn.addEventListener('click', function() {
      mainNav.classList.toggle('active');
      mobileMenuBtn.classList.toggle('active');
    });

    // Close menu when clicking on a link
    const navLinks = mainNav.querySelectorAll('.nav-link');
    navLinks.forEach(link => {
      link.addEventListener('click', function() {
        mainNav.classList.remove('active');
        mobileMenuBtn.classList.remove('active');
      });
    });

    // Close menu when clicking outside
    document.addEventListener('click', function(e) {
      if (!mainNav.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
        mainNav.classList.remove('active');
        mobileMenuBtn.classList.remove('active');
      }
    });
  }
});
</script>
{% endblock %}

{% block body %}
<style>
  .page-dark { background: transparent; color:#111827; }
  .muted { color:#6b7280; }
  .accent-link { color:#374151; }
  .accent-link:hover { color:#111827; }
</style>
<!-- Page Header -->
<section class="border-b page-hero" style="border-color:#e5e7eb;box-shadow:0 1px 0 rgba(17,24,39,.04);">
    <div class="page-header-container">
        <div class="page-header-content">
            <div class="page-header-main">
                <nav class="breadcrumb-nav" aria-label="Breadcrumb">
                    <ol class="breadcrumb-list">
                        <li>
                            <a href="{{ path('public_home') }}" class="breadcrumb-link">{{ 'Ana Sayfa'|auto_translate(app.request.locale) }}</a>
                        </li>
                        <li class="breadcrumb-separator">
                            <svg class="breadcrumb-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                            </svg>
                            {% if selectedCategory %}
                                <a href="{{ path('public_products') }}" class="breadcrumb-link">{{ 'nav.products'|trans }}</a>
                            {% else %}
                                <span class="breadcrumb-current">{{ 'nav.products'|trans }}</span>
                            {% endif %}
                        </li>
                        {% if selectedCategory %}
                            <li class="breadcrumb-separator">
                                <svg class="breadcrumb-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                </svg>
                                <span class="breadcrumb-current">{{ selectedCategory.name |auto_translate(app.request.locale) }}</span>
                            </li>
                        {% endif %}
                    </ol>
                </nav>

                <h1 class="page-title">
                    {% if selectedCategory %}
                        {{ selectedCategory|smart_translate('name', app.request.locale) }}
                    {% elseif search %}
                        "{{ search }}" {{ 'hero.search_button'|trans|lower }} {{ 'table.actions'|trans|lower }}
                    {% else %}
                        {{ 'products.all_products'|trans }}
                    {% endif %}
                </h1>

                <p class="page-subtitle">
                    {% if totalProducts > 0 %}
                        {{ totalProducts }} ürün bulundu
                    {% else %}
                    {{'Ürün bulunamadı'|auto_translate(app.request.locale)}}
                    {% endif %}
                </p>
            </div>

            <!-- Search Form -->
            <div class="search-form-container">
                <form method="GET" class="search-form">
                    {% if selectedCategory %}
                        <input type="hidden" name="category" value="{{ selectedCategory.id }}">
                    {% endif %}

                    <div class="sort-select-container">
                        <select name="sort" class="sort-select" onchange="this.form.submit()">
                            <option value="" {% if not sort %}selected{% endif %}>{{ 'sort.label'|trans }}</option>
                            <option value="price_asc" {% if sort == 'price_asc' %}selected{% endif %}>{{ 'sort.price_asc'|trans }}</option>
                            <option value="price_desc" {% if sort == 'price_desc' %}selected{% endif %}>{{ 'sort.price_desc'|trans }}</option>
                            <option value="name_asc" {% if sort == 'name_asc' %}selected{% endif %}>{{ 'sort.name_asc'|trans }}</option>
                            <option value="name_desc" {% if sort == 'name_desc' %}selected{% endif %}>{{ 'sort.name_desc'|trans }}</option>
                        </select>
                    </div>

                    <div class="search-input-container">
                        <input type="text"
                               name="search"
                               value="{{ search }}"
                               placeholder="{{ 'Ürün, marka veya firma ara...'|auto_translate(app.request.locale) }}"
                               class="search-input">
                        <div class="search-icon">
                            <svg class="search-icon-svg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                            </svg>
                        </div>
                    </div>

                    <button type="submit" class="search-button">
                        {{ 'Ara'|auto_translate(app.request.locale) }}
                    </button>
                </form>
            </div>
        </div>
    </div>
</section>

<style>
.page-header-container {
  max-width: 80%;
  margin: 0 auto;
  padding: 32px 16px;
}

.page-header-content {
  display: flex;
  flex-direction: column;
  gap: 24px;
}

.page-header-main {
  flex: 1;
}

.breadcrumb-nav {
  margin-bottom: 16px;
}

.breadcrumb-list {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  color: #6b7280;
}

.breadcrumb-link {
  color: #6b7280;
  text-decoration: none;
  transition: color 0.2s ease;
}

.breadcrumb-link:hover {
  color: #3b82f6;
}

.breadcrumb-current {
  color: #111827;
  font-weight: 500;
}

.breadcrumb-separator {
  display: flex;
  align-items: center;
}

.breadcrumb-icon {
  width: 16px;
  height: 16px;
  margin: 0 8px;
}

.page-title {
  font-size: 32px;
  font-weight: 700;
  color: #111827;
  margin-bottom: 8px;
  line-height: 1.2;
}

.page-subtitle {
  color: #6b7280;
  font-size: 16px;
}

.search-form-container {
  width: 100%;
}

.search-form {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.sort-select-container {
  width: 100%;
}

.sort-select {
  width: 100%;
  padding: 10px 12px;
  border: 1px solid #d1d5db;
  border-radius: 8px;
  background: white;
  color: #111827;
  font-size: 14px;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.sort-select:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.search-input-container {
  position: relative;
  width: 100%;
}

.search-input {
  width: 100%;
  padding: 10px 12px 10px 40px;
  border: 1px solid #d1d5db;
  border-radius: 8px;
  background: white;
  color: #111827;
  font-size: 14px;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.search-input:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.search-input::placeholder {
  color: #9ca3af;
}

.search-icon {
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  pointer-events: none;
}

.search-icon-svg {
  width: 20px;
  height: 20px;
  color: #9ca3af;
}

.search-button {
  width: 100%;
  padding: 10px 24px;
  background: #C0C0C0;
  color: #111111;
  border: none;
  border-radius: 8px;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.search-button:hover {
  background: #B8B8B8;
}

/* Responsive styles */
@media (min-width: 640px) {
  .search-form {
    flex-direction: row;
    align-items: center;
  }

  .sort-select-container {
    width: auto;
    min-width: 150px;
  }

  .search-input-container {
    flex: 1;
    min-width: 200px;
  }

  .search-button {
    width: auto;
    min-width: 100px;
  }
}

@media (min-width: 1024px) {
  .page-header-content {
    flex-direction: row;
    align-items: flex-end;
    justify-content: space-between;
  }

  .search-form-container {
    width: auto;
    margin-left: 32px;
  }

  .search-form {
    gap: 12px;
  }
}

@media (max-width: 640px) {
  .page-header-container {
    max-width: 100%;
    padding: 24px 16px;
  }

  .page-title {
    font-size: 24px;
  }

  .breadcrumb-list {
    font-size: 13px;
  }

  .breadcrumb-icon {
    width: 14px;
    height: 14px;
    margin: 0 6px;
  }
}

@media (max-width: 480px) {
  .page-header-container {
    padding: 20px 12px;
  }

  .page-title {
    font-size: 20px;
  }

  .page-subtitle {
    font-size: 14px;
  }

  .search-input {
    font-size: 16px; /* Prevents zoom on iOS */
  }
}

/* Main Content Layout */
.main-content-container {
  max-width: 80%;
  margin: 0 auto;
  padding: 32px 16px;
  background: transparent;
}

.main-content-layout {
  display: flex;
  flex-direction: column;
  gap: 32px;
}

.mobile-sidebar-toggle {
  display: none;
  align-items: center;
  gap: 8px;
  padding: 12px 16px;
  background: #f8fafc;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  color: #374151;
  font-weight: 500;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.mobile-sidebar-toggle:hover {
  background: #f1f5f9;
  border-color: #cbd5e1;
}

.sidebar {
  width: 100%;
  flex-shrink: 0;
}

.sidebar-content {
  background: #ffffff;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  padding: 24px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  position: sticky;
  top: 100px;
}

.main-content {
  flex: 1;
  min-width: 0;
}

/* Responsive Layout */
@media (min-width: 1024px) {
  .main-content-layout {
    flex-direction: row;
    gap: 32px;
  }

  .sidebar {
    width: 256px;
  }

  .main-content {
    flex: 1;
  }
}

@media (max-width: 1023px) {
  .main-content-container {
    max-width: 100%;
    padding: 24px 16px;
  }

  .mobile-sidebar-toggle {
    display: flex;
  }

  .sidebar {
    position: fixed;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100vh;
    background: white;
    z-index: 50;
    transition: left 0.3s ease;
    overflow-y: auto;
  }

  .sidebar.active {
    left: 0;
  }

  .sidebar-content {
    position: static;
    border: none;
    border-radius: 0;
    box-shadow: none;
    padding: 24px;
    height: 100%;
  }
}

@media (max-width: 640px) {
  .main-content-container {
    padding: 20px 12px;
  }

  .main-content-layout {
    gap: 20px;
  }

  .mobile-sidebar-toggle {
    padding: 10px 12px;
    font-size: 13px;
  }

  .sidebar-content {
    padding: 20px;
  }
}

/* Products Grid */
.products-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 24px;
  margin-bottom: 32px;
}

.product-card {
  background: #ffffff;
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  display: flex;
  flex-direction: column;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.product-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.product-image-container {
  position: relative;
  height: 200px;
  overflow: hidden;
  background: #f9fafb;
}

.product-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.3s ease;
}

.product-card:hover .product-image {
  transform: scale(1.05);
}

.product-badges {
  position: absolute;
  top: 16px;
  left: 16px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.product-badge {
  padding: 6px 12px;
  font-size: 12px;
  font-weight: 600;
  border-radius: 999px;
  backdrop-filter: blur(8px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.badge-sale {
  background: rgba(16, 185, 129, 0.9);
  color: white;
}

.badge-rent {
  background: rgba(59, 130, 246, 0.9);
  color: white;
}

.badge-new {
  background: rgba(245, 158, 11, 0.9);
  color: white;
}

.badge-used {
  background: rgba(249, 115, 22, 0.9);
  color: white;
}

.product-quick-view {
  position: absolute;
  inset: 0;
  background: linear-gradient(to top, rgba(0, 0, 0, 0.2), transparent);
  opacity: 0;
  transition: opacity 0.3s ease;
  display: flex;
  align-items: flex-end;
  padding: 16px;
}

.product-card:hover .product-quick-view {
  opacity: 1;
}

.quick-view-button {
  width: 100%;
  background: white;
  color: #111827;
  text-align: center;
  padding: 10px 16px;
  border-radius: 8px;
  font-weight: 500;
  font-size: 14px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  transform: translateY(8px);
  transition: transform 0.3s ease;
  text-decoration: none;
}

.product-card:hover .quick-view-button {
  transform: translateY(0);
}

.product-info {
  padding: 24px;
  flex: 1;
  display: flex;
  flex-direction: column;
}

.product-title {
  font-size: 20px;
  font-weight: 700;
  color: #111827;
  margin-bottom: 12px;
  line-height: 1.3;
}

.product-title a {
  color: inherit;
  text-decoration: none;
  transition: color 0.2s ease;
}

.product-title a:hover {
  color: #3b82f6;
}

.product-details {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-bottom: 16px;
}

.product-detail-item {
  display: flex;
  align-items: flex-start;
  gap: 12px;
}

.product-detail-icon {
  width: 16px;
  height: 16px;
  color: #9ca3af;
  margin-top: 2px;
  flex-shrink: 0;
}

.product-detail-content {
  flex: 1;
}

.product-detail-label {
  font-size: 12px;
  font-weight: 500;
  color: #111827;
  margin-bottom: 2px;
}

.product-detail-value {
  font-size: 13px;
  color: #6b7280;
}

.product-description {
  color: #6b7280;
  font-size: 14px;
  line-height: 1.5;
  margin-bottom: 20px;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.product-footer {
  margin-top: auto;
  padding-top: 16px;
  border-top: 1px solid #f3f4f6;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
}

.product-price {
  font-size: 18px;
  font-weight: 800;
  color: #111827;
}

.product-price-contact {
  font-size: 14px;
  color: #6b7280;
}

.product-detail-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 8px 16px;
  background: #C0C0C0;
  color: #111111;
  border-radius: 8px;
  font-weight: 600;
  font-size: 14px;
  text-decoration: none;
  transition: all 0.3s ease;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.product-detail-button:hover {
  background: #B8B8B8;
  transform: scale(1.05);
}

/* Responsive Grid */
@media (min-width: 640px) {
  .products-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 20px;
  }

  .product-image-container {
    height: 180px;
  }
}

@media (min-width: 1024px) {
  .products-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 24px;
  }

  .product-image-container {
    height: 200px;
  }
}

@media (min-width: 1280px) {
  .products-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 24px;
  }

  .product-image-container {
    height: 220px;
  }
}

@media (max-width: 640px) {
  .products-grid {
    gap: 16px;
    margin-bottom: 24px;
  }

  .product-image-container {
    height: 160px;
  }

  .product-info {
    padding: 20px;
  }

  .product-title {
    font-size: 18px;
  }

  .product-footer {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
  }

  .product-detail-button {
    width: 100%;
    justify-content: center;
  }
}

@media (max-width: 480px) {
  .products-grid {
    gap: 12px;
  }

  .product-image-container {
    height: 140px;
  }

  .product-info {
    padding: 16px;
  }

  .product-title {
    font-size: 16px;
  }

  .product-badges {
    top: 12px;
    left: 12px;
    gap: 6px;
  }

  .product-badge {
    padding: 4px 8px;
    font-size: 11px;
  }
}

/* Pagination Styles */
.pagination-container {
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-top: 1px solid #e5e7eb;
  background: white;
  padding: 16px 20px;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.pagination-mobile {
  display: flex;
  flex: 1;
  justify-content: space-between;
}

.pagination-mobile-btn {
  display: inline-flex;
  align-items: center;
  padding: 8px 16px;
  border: 1px solid #d1d5db;
  border-radius: 6px;
  background: white;
  color: #374151;
  font-size: 14px;
  font-weight: 500;
  text-decoration: none;
  transition: all 0.2s ease;
}

.pagination-mobile-btn:hover {
  background: #f9fafb;
  border-color: #9ca3af;
}

.pagination-desktop {
  display: none;
  flex: 1;
  align-items: center;
  justify-content: space-between;
}

.pagination-info {
  flex: 1;
}

.pagination-text {
  font-size: 14px;
  color: #6b7280;
}

.pagination-number {
  font-weight: 500;
  color: #111827;
}

.pagination-nav {
  display: flex;
  align-items: center;
  gap: 2px;
}

.pagination-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 40px;
  height: 40px;
  padding: 0 12px;
  border: 1px solid #d1d5db;
  background: white;
  color: #374151;
  font-size: 14px;
  font-weight: 500;
  text-decoration: none;
  transition: all 0.2s ease;
  position: relative;
}

.pagination-btn:first-child {
  border-top-left-radius: 6px;
  border-bottom-left-radius: 6px;
}

.pagination-btn:last-child {
  border-top-right-radius: 6px;
  border-bottom-right-radius: 6px;
}

.pagination-btn:hover {
  background: #f9fafb;
  border-color: #9ca3af;
  z-index: 10;
}

.pagination-current {
  background: #3b82f6;
  color: white;
  border-color: #3b82f6;
  z-index: 10;
}

.pagination-current:hover {
  background: #2563eb;
  border-color: #2563eb;
}

.pagination-prev,
.pagination-next {
  padding: 0 8px;
}

.pagination-icon {
  width: 20px;
  height: 20px;
}

.pagination-ellipsis {
  border: none;
  background: transparent;
  color: #6b7280;
  cursor: default;
}

.pagination-ellipsis:hover {
  background: transparent;
  border-color: transparent;
}

/* Responsive Pagination */
@media (min-width: 640px) {
  .pagination-mobile {
    display: none;
  }

  .pagination-desktop {
    display: flex;
  }
}

@media (max-width: 640px) {
  .pagination-container {
    padding: 12px 16px;
  }

  .pagination-mobile-btn {
    padding: 6px 12px;
    font-size: 13px;
  }
}

@media (max-width: 480px) {
  .pagination-container {
    padding: 10px 12px;
  }

  .pagination-mobile-btn {
    padding: 6px 10px;
    font-size: 12px;
  }
}

/* Footer Styles */
.main-footer {
  background: #0a0a0a;
  color: #bdbdbd;
  border-top: 1px solid #1a1a1a;
}

.footer-container {
  max-width: 80%;
  margin: 0 auto;
  padding: 28px 16px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
}

.footer-brand {
  display: flex;
  align-items: center;
  gap: 10px;
}

.footer-logo {
  display: inline-flex;
  align-items: center;
}

.footer-logo-img {
  height: 46px;
  width: auto;
  border-radius: 6px;
  object-fit: contain;
  display: block;
}

.footer-copyright {
  color: #6b6b6b;
}

.footer-nav {
  display: flex;
  gap: 18px;
  align-items: center;
  font-size: 13px;
}

.footer-link {
  color: #bdbdbd;
  text-decoration: none;
  transition: color 0.2s ease;
}

.footer-link:hover {
  color: #ffffff;
}

/* Responsive Footer */
@media (max-width: 768px) {
  .footer-container {
    flex-direction: column;
    text-align: center;
    gap: 20px;
    padding: 24px 16px;
  }

  .footer-brand {
    flex-direction: column;
    gap: 8px;
  }

  .footer-nav {
    flex-wrap: wrap;
    justify-content: center;
    gap: 16px;
  }
}

@media (max-width: 480px) {
  .footer-container {
    padding: 20px 12px;
  }

  .footer-logo-img {
    height: 40px;
  }

  .footer-nav {
    gap: 12px;
    font-size: 12px;
  }
}
</style>
<div class="hero-fade"></div>

<div class="main-content-container">
    <div class="main-content-layout">
        <!-- Mobile Sidebar Toggle -->
        <button class="mobile-sidebar-toggle" id="mobileSidebarToggle">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
            <span>Kategoriler</span>
        </button>

        <!-- Sidebar - Categories (contextual) -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-content">
                {% if selectedCategory %}
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">{{ selectedCategory.name|auto_translate(app.request.locale) }}</h3>
                    <div class="space-y-2">
                        <a href="{{ path('public_products') }}" class="block w-full text-left px-3 py-2 rounded-md text-sm font-medium text-gray-600 hover:bg-gray-100">{{ 'products.all_products'|trans }}</a>
                        {% for child in selectedCategory.children %}
                            {% if child.isActive %}
                                <div class="space-y-1">
                                    <a href="{{ path('public_products', {category: child.id}) }}"
                                       class="block w-full text-left px-3 py-2 rounded-md text-sm font-medium transition-colors {% if selectedCategory and selectedCategory.id == child.id %}bg-gray-100 text-gray-900{% else %}text-gray-700 hover:bg-gray-100{% endif %}">
                                        <svg class="w-3 h-3 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
                                        {{ child.name |auto_translate(app.request.locale) }}
                                    </a>
                                    {% set activeGrandchildren = [] %}
                                    {% for grandchild in child.children %}
                                        {% if grandchild.isActive %}
                                            {% set activeGrandchildren = activeGrandchildren|merge([grandchild]) %}
                                        {% endif %}
                                    {% endfor %}
                                    {% if activeGrandchildren|length > 0 %}
                                        <div class="ml-4">
                                            {% for grandchild in activeGrandchildren %}
                                                <a href="{{ path('public_products', {category: grandchild.id}) }}"
                                                   class="block w-full text-left px-3 py-1.5 rounded-md text-xs transition-colors text-gray-600 hover:bg-gray-100">
                                                    <svg class="w-2 h-2 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
                                                    {{ grandchild.name|auto_translate(app.request.locale) }}
                                                </a>
                                            {% endfor %}
                                        </div>
                                    {% endif %}
                                </div>
                            {% endif %}
                        {% endfor %}
                    </div>
                {% else %}
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">{{ 'nav.categories'|trans }}</h3>
                    <div class="space-y-2" id="categoryAccordion">
                        <a href="{{ path('public_products') }}"
                           class="block w-full text-left px-3 py-2 rounded-md text-sm font-medium transition-colors {% if not selectedCategory %}bg-gray-100 text-gray-900{% else %}text-gray-700 hover:bg-gray-100{% endif %}">{{ 'products.all_products'|trans }}</a>
                        {% for category in categories %}
                            {% if category.parent is null and category.isActive %}
                                <div class="category-item" data-category-id="{{ category.id }}">
                                    <!-- Main Category Row -->
                                    <div class="flex items-center">
                                        <!-- Category Name (clickable for filtering) -->
                                        <a href="{{ path('public_products', {category: category.id}) }}"
                                           class="flex-1 px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100 transition-colors category-link">
                                            {{ category|smart_translate('name', app.request.locale) }}
                                        </a>

                                        <!-- Expand/Collapse Arrow (only if has children) -->
                                        {% if category.children|length > 0 %}
                                            <button type="button"
                                                    class="p-2 hover:bg-gray-100 rounded-md transition-colors category-toggle"
                                                    data-target="category-{{ category.id }}"
                                                    aria-expanded="false">
                                                <svg class="w-4 h-4 text-gray-500 transform transition-transform duration-200"
                                                     fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                                </svg>
                                            </button>
                                        {% endif %}
                                    </div>

                                    <!-- Subcategories (collapsible) -->
                                    {% if category.children|length > 0 %}
                                        <div id="category-{{ category.id }}"
                                             class="category-children hidden ml-4 mt-1 space-y-1 transition-all duration-300">
                                            {% for child in category.children %}
                                                {% if child.isActive %}
                                                    <div class="subcategory-item" data-category-id="{{ child.id }}">
                                                        <!-- Subcategory Row -->
                                                        <div class="flex items-center">
                                                            <!-- Subcategory Name -->
                                                            <a href="{{ path('public_products', {category: child.id}) }}"
                                                               class="flex-1 px-3 py-1.5 rounded-md text-xs text-gray-600 hover:bg-gray-100 transition-colors category-link {% if selectedCategory and selectedCategory.id == child.id %}bg-gray-100 text-gray-900 font-medium{% endif %}">
                                                                <svg class="w-3 h-3 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                                                </svg>
                                                                {{ child|smart_translate('name', app.request.locale) }}
                                                            </a>

                                                            <!-- Sub-subcategory Arrow -->
                                                            {% if child.children|length > 0 %}
                                                                <button type="button"
                                                                        class="p-1.5 hover:bg-gray-100 rounded-md transition-colors category-toggle"
                                                                        data-target="subcategory-{{ child.id }}"
                                                                        aria-expanded="false">
                                                                    <svg class="w-3 h-3 text-gray-400 transform transition-transform duration-200"
                                                                         fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                                                    </svg>
                                                                </button>
                                                            {% endif %}
                                                        </div>

                                                        <!-- Sub-subcategories -->
                                                        {% if child.children|length > 0 %}
                                                            <div id="subcategory-{{ child.id }}"
                                                                 class="category-children hidden ml-4 mt-1 space-y-1">
                                                                {% for grandchild in child.children %}
                                                                    {% if grandchild.isActive %}
                                                                        <a href="{{ path('public_products', {category: grandchild.id}) }}"
                                                                           class="block px-3 py-1 rounded-md text-xs text-gray-500 hover:bg-gray-100 transition-colors category-link {% if selectedCategory and selectedCategory.id == grandchild.id %}bg-gray-100 text-gray-900 font-medium{% endif %}">
                                                                            <svg class="w-2 h-2 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                                                            </svg>
                                                                            {{ grandchild|smart_translate('name', app.request.locale) }}
                                                                        </a>
                                                                    {% endif %}
                                                                {% endfor %}
                                                            </div>
                                                        {% endif %}
                                                    </div>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                    {% endif %}
                                </div>
                            {% endif %}
                        {% endfor %}
                    </div>
                {% endif %}
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            {% if products|length > 0 %}
                <!-- Products Grid -->
                <div class="products-grid">
                    {% for product in products %}
                        <div class="product-card">
                            <!-- Product Image -->
                            <div class="product-image-container">
                                {% if product.images|length > 0 %}
                                    <img src="{{ asset(product.images.first.imagePath) }}"
                                         alt="{{ product|smart_translate('name', app.request.locale) }}"
                                         class="product-image">
                                {% else %}
                                    <div class="flex items-center justify-center h-full">
                                        <div class="w-20 h-20 rounded-3xl flex items-center justify-center bg-gray-100">
                                            <svg class="w-10 h-10 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                            </svg>
                                        </div>
                                    </div>
                                {% endif %}

                                <!-- Status Badges -->
                                {#<div class="product-badges">
                                    <span class="product-badge {% if product.productStatus == 'satilik' %}badge-sale{% else %}badge-rent{% endif %}">
                                        {{ product.productStatus == 'satilik' ? ('Satılık'|auto_translate(app.request.locale)) : ('Kiralık'|auto_translate(app.request.locale)) }}
                                    </span>
                                    {% if product.productType %}
                                        <span class="product-badge {% if product.productType == 'sifir' %}badge-new{% else %}badge-used{% endif %}">
                                            {{ product.productType == 'sifir' ? ('Sıfır'|auto_translate(app.request.locale)) : ('İkinci El'|auto_translate(app.request.locale)) }}
                                        </span>
                                    {% endif %}
                                </div>#}

                                <!-- Quick View Overlay -->
                                <div class="product-quick-view">
                                    <a href="{{ path('public_product_detail', {id: product.id}) }}" class="quick-view-button">
                                        {{ 'Detayları Görüntüle'|auto_translate(app.request.locale) }}
                                    </a>
                                </div>
                            </div>

                            <!-- Product Info -->
                            <div class="product-info">
                                <!-- Product Name -->
                                <h3 class="product-title">
                                    <a href="{{ path('public_product_detail', {id: product.id}) }}">
                                        {{ product|smart_translate('name', app.request.locale) }}
                                    </a>
                                </h3>

                                <!-- Product Details -->
                                <div class="product-details">
                                    {% if product.brand %}
                                        <div class="product-detail-item">
                                            <svg class="product-detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                                            </svg>
                                            <div class="product-detail-content">
                                                <div class="product-detail-label">{{ product.brand }}</div>
                                                {% if product.modelType %}
                                                    <div class="product-detail-value">{{ product.modelType }}</div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    {% endif %}

                                    {% if product.category %}
                                        <div class="product-detail-item">
                                            <svg class="product-detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                                            </svg>
                                            <div class="product-detail-content">
                                                <a href="{{ path('public_products', {category: product.category.id}) }}" class="product-detail-value accent-link">
                                                    {{ product.category.name }}
                                                </a>
                                            </div>
                                        </div>
                                    {% endif %}

                                    {% if product.company %}
                                        <div class="product-detail-item">
                                            <svg class="product-detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                                            </svg>
                                            <div class="product-detail-content">
                                                <a href="{{ path('public_company_detail', {id: product.company.id}) }}" class="product-detail-value" style="color: #3b82f6; font-weight: 500;">
                                                    {{ product.company.name }}
                                                </a>
                                            </div>
                                        </div>
                                    {% endif %}
                                </div>

                                <!-- Description -->
                                {% if product.description %}
                                    <p class="product-description">
                                        {% set translatedDesc = product|smart_translate('description', app.request.locale) %}
                                        {{ translatedDesc|slice(0, 120) }}{% if translatedDesc|length > 120 %}...{% endif %}
                                    </p>
                                {% endif %}

                                <!-- Footer Actions -->
                                <div class="product-footer">
                                    <div class="product-price">
                                        {% if product.price and product.currency %}
                                            {% set currencySymbols = {'TRY':'₺','USD':'$','EUR':'€','GBP':'£'} %}
                                            <span>{{ currencySymbols[product.currency]|default(product.currency) }}</span>
                                            <span>{{ product.price|number_format(2, ',', '.') }}</span>
                                        {% else %}
                                            <span class="product-price-contact">Fiyat için iletişime geçin</span>
                                        {% endif %}
                                    </div>
                                    <a href="{{ path('public_product_detail', {id: product.id}) }}" class="product-detail-button">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                        </svg>
                                        {{ 'Ürün Detayı'|auto_translate(app.request.locale) }}
                                    </a>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>

                <!-- Pagination -->
                {% if totalPages > 1 %}
                    <div class="pagination-container">
                        <!-- Mobile Pagination -->
                        <div class="pagination-mobile">
                            {% if currentPage > 1 %}
                                <a href="{{ path('public_products', app.request.query.all|merge({page: currentPage - 1})) }}" class="pagination-mobile-btn">
                                    Önceki
                                </a>
                            {% endif %}
                            {% if currentPage < totalPages %}
                                <a href="{{ path('public_products', app.request.query.all|merge({page: currentPage + 1})) }}" class="pagination-mobile-btn">
                                    Sonraki
                                </a>
                            {% endif %}
                        </div>

                        <!-- Desktop Pagination -->
                        <div class="pagination-desktop">
                            <div class="pagination-info">
                                <p class="pagination-text">
                                    <span class="pagination-number">{{ ((currentPage - 1) * 12) + 1 }}</span>
                                    -
                                    <span class="pagination-number">{{ (currentPage * 12) > totalProducts ? totalProducts : (currentPage * 12) }}</span>
                                    arası,
                                    <span class="pagination-number">{{ totalProducts }}</span>
                                    sonuçtan
                                </p>
                            </div>
                            <nav class="pagination-nav" aria-label="Pagination">
                                <!-- Previous Page -->
                                {% if currentPage > 1 %}
                                    <a href="{{ path('public_products', app.request.query.all|merge({page: currentPage - 1})) }}" class="pagination-btn pagination-prev">
                                        <svg class="pagination-icon" viewBox="0 0 20 20" fill="currentColor">
                                            <path fill-rule="evenodd" d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z" clip-rule="evenodd" />
                                        </svg>
                                    </a>
                                {% endif %}

                                <!-- Page Numbers -->
                                {% for page in 1..totalPages %}
                                    {% if page == currentPage %}
                                        <span class="pagination-btn pagination-current">{{ page }}</span>
                                    {% elseif page == 1 or page == totalPages or (page >= currentPage - 2 and page <= currentPage + 2) %}
                                        <a href="{{ path('public_products', app.request.query.all|merge({page: page})) }}" class="pagination-btn pagination-page">{{ page }}</a>
                                    {% elseif page == currentPage - 3 or page == currentPage + 3 %}
                                        <span class="pagination-btn pagination-ellipsis">...</span>
                                    {% endif %}
                                {% endfor %}

                                <!-- Next Page -->
                                {% if currentPage < totalPages %}
                                    <a href="{{ path('public_products', app.request.query.all|merge({page: currentPage + 1})) }}" class="pagination-btn pagination-next">
                                        <svg class="pagination-icon" viewBox="0 0 20 20" fill="currentColor">
                                            <path fill-rule="evenodd" d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z" clip-rule="evenodd" />
                                        </svg>
                                    </a>
                                {% endif %}
                            </nav>
                        </div>
                    </div>
                {% endif %}

            {% else %}
                <!-- No Products Found -->
                <div class="rounded-lg shadow-sm border p-12 text-center card-light">
                    <svg class="mx-auto h-16 w-16 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path>
                    </svg>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">{{'Ürün Bulunamadı' |auto_translate(app.request.locale)}}</h3>
                    <p class="text-gray-600 mb-6">
                        {% if search %}
                            {{ ('"' ~ search ~ '" aramanızla eşleşen ürün bulunamadı.') | auto_translate(app.request.locale) }}
                        {% elseif selectedCategory %}
                            {{ (selectedCategory.name ~ ' kategorisinde henüz ürün bulunmuyor.') | auto_translate(app.request.locale) }}
                        {% else %}
                            {{ 'Henüz hiç ürün eklenmemiş.' | auto_translate(app.request.locale) }}
                        {% endif %}
                    </p>
                    <div class="flex flex-col sm:flex-row gap-3 justify-center">
                        <a href="{{ path('public_products') }}"
                           class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
                            <svg class="w-4 h-4 mr-2 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                            </svg>
                            {{ 'products.all_products'|trans }}
                        </a>
                        <a href="{{ path('public_home') }}"
                           class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700">
                            <svg class="w-4 h-4 mr-2 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                            </svg>
                            {{ 'Ana Sayfa'|auto_translate(app.request.locale) }}
                        </a>
                    </div>
                </div>
            {% endif %}
        </main>
    </div>
</div>
{% endblock %}

{% block footer %}
<footer class="main-footer">
  <div class="footer-container">
    <div class="footer-brand">
      <a href="{{ path('public_home') }}" class="footer-logo">
        <img src="{{ asset('mineindustries_logo_transparent_pad8.png') }}" alt="Makine Ticaret" class="footer-logo-img"/>
      </a>
      <span class="footer-copyright">© {{ "now"|date("Y") }}</span>
    </div>
    <nav class="footer-nav">
      <a href="{{ path('public_products') }}" class="footer-link">{{ 'nav.products'|trans }}</a>
      <a href="{{ path('public_categories') }}" class="footer-link">{{ 'nav.categories'|trans }}</a>
      <a href="{{ path('public_companies') }}" class="footer-link">{{ 'nav.companies'|trans }}</a>
      <a href="{{ path('public_bids') }}" class="footer-link">{{ 'nav.bids'|trans }}</a>
    </nav>
  </div>
</footer>

<!-- Category Accordion JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Category accordion functionality
    const categoryToggles = document.querySelectorAll('.category-toggle');

    categoryToggles.forEach(toggle => {
        toggle.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();

            const targetId = this.getAttribute('data-target');
            const targetElement = document.getElementById(targetId);
            const arrow = this.querySelector('svg');
            const isExpanded = this.getAttribute('aria-expanded') === 'true';

            if (targetElement) {
                if (isExpanded) {
                    // Collapse
                    targetElement.classList.add('hidden');
                    this.setAttribute('aria-expanded', 'false');
                    arrow.style.transform = 'rotate(0deg)';
                } else {
                    // Expand
                    targetElement.classList.remove('hidden');
                    this.setAttribute('aria-expanded', 'true');
                    arrow.style.transform = 'rotate(90deg)';
                }
            }
        });
    });

    // Auto-expand if current category is selected
    {% if selectedCategory %}
        const selectedCategoryId = {{ selectedCategory.id }};

        // Find and expand parent categories
        const selectedLinks = document.querySelectorAll('.category-link');
        selectedLinks.forEach(link => {
            if (link.href.includes('category=' + selectedCategoryId)) {
                // Find parent category containers and expand them
                let parent = link.closest('.category-item, .subcategory-item');
                while (parent) {
                    const toggle = parent.querySelector('.category-toggle');
                    if (toggle) {
                        const targetId = toggle.getAttribute('data-target');
                        const targetElement = document.getElementById(targetId);
                        const arrow = toggle.querySelector('svg');

                        if (targetElement && targetElement.classList.contains('hidden')) {
                            targetElement.classList.remove('hidden');
                            toggle.setAttribute('aria-expanded', 'true');
                            if (arrow) arrow.style.transform = 'rotate(90deg)';
                        }
                    }
                    // Look for parent category
                    parent = parent.parentElement.closest('.category-item, .subcategory-item');
                }
            }
        });
    {% endif %}

    // Smooth scrolling for category links
    const categoryLinks = document.querySelectorAll('.category-link');
    categoryLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            // Allow normal navigation (don't prevent default)
            // Add loading state if needed
            this.style.opacity = '0.7';
        });
    });

    // Mobile sidebar toggle
    const mobileSidebarToggle = document.getElementById('mobileSidebarToggle');
    const sidebar = document.getElementById('sidebar');

    if (mobileSidebarToggle && sidebar) {
        mobileSidebarToggle.addEventListener('click', function() {
            sidebar.classList.toggle('active');
        });

        // Close sidebar when clicking outside
        document.addEventListener('click', function(e) {
            if (!sidebar.contains(e.target) && !mobileSidebarToggle.contains(e.target)) {
                sidebar.classList.remove('active');
            }
        });

        // Close sidebar when clicking on a category link
        const categoryLinks = sidebar.querySelectorAll('a');
        categoryLinks.forEach(link => {
            link.addEventListener('click', function() {
                sidebar.classList.remove('active');
            });
        });
    }
});
</script>

{% endblock %}
